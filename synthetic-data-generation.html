<!DOCTYPE html>
<head>
    <link rel="icon" type="image/png" sizes="16x16" href="/favicons/favicon-16x16.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="48x48" href="/favicons/favicon.ico">

    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css"
          integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">

    
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js"
            integrity="sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4"
            crossorigin="anonymous"></script>

    
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js"
            integrity="sha384-mll67QQFJfxn0IYznZYonOWZ644AWYC+Pt2cHqMaRhXVrursRwvLnLaebdGIlYNa" crossorigin="anonymous"
            onload="renderMathInElement(document.body);"></script>

    <link href="https://fonts.googleapis.com/css?family=Nunito:400,300i,800&display=swap" rel="stylesheet"/>
    <link href="/assets/style.css" rel="stylesheet"/>
    <title>ruivieira.dev - Synthetic Data Generation</title>
    <script type="application/javascript">
        var doNotTrack = false;
        if (!doNotTrack) {
            (function (i, s, o, g, r, a, m) {
                i['GoogleAnalyticsObject'] = r;
                i[r] = i[r] || function () {
                    (i[r].q = i[r].q || []).push(arguments)
                }, i[r].l = 1 * new Date();
                a = s.createElement(o),
                    m = s.getElementsByTagName(o)[0];
                a.async = 1;
                a.src = g;
                m.parentNode.insertBefore(a, m)
            })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');
            ga('create', 'UA-10507665-2', 'auto');

            ga('send', 'pageview');
        }
    </script>
</head>
<body>

<div id="sidebar">
    <a href="/">home</a>
    
        <h2>Contents</h2>
        <ul>
            
                <li class="heading-2"><a href="#regression-data">Regression data</a></li>
            
                <li class="heading-3"><a href="#changing-the-gaussian-noise-level">Changing the Gaussian noise level</a></li>
            
                <li class="heading-3"><a href="#visualising-increasing-noise">Visualising increasing noise</a></li>
            
                <li class="heading-2"><a href="#classification-data">Classification data</a></li>
            
                <li class="heading-3"><a href="#cluster-separation">Cluster separation</a></li>
            
                <li class="heading-3"><a href="#noise-level">Noise level</a></li>
            
                <li class="heading-2"><a href="#separability">Separability</a></li>
            
                <li class="heading-3"><a href="#anisotropic-data">Anisotropic data</a></li>
            
                <li class="heading-2"><a href="#concentric-clusters">Concentric clusters</a></li>
            
                <li class="heading-3"><a href="#adding-noise">Adding noise</a></li>
            
                <li class="heading-2"><a href="#moon-clusters">Moon clusters</a></li>
            
                <li class="heading-3"><a href="#adding-noise">Adding noise</a></li>
            
        </ul>
    
    
        <h2>Backlinks</h2>

        <ul>
            
                <li><a href="machine-learning.html">Machine Learning</a><sup>&#5833</sup></li>
            
            <li><a href="/content.html">content</a><sup>&#5833</sup></li>

        </ul>
    
    <div class="footer">
        modified 1609779783
    </div>

</div>

<div id="content">
    <h1 id="generating-synthetic-data">Generating synthetic data</h1>
<p>Synthetic data will be used mainly for these scenarios:</p>
<ul>
<li>Regression</li>
<li>Classification</li>
</ul>
<h2 id="regression-data">Regression data</h2>
<p>What does a regression consist of?</p>
<p>For this section we will mainly use <code>scikit-learn</code>'s <a href="https://scikit-learn.org/stable/modules/generated/sklearn.datasets.make_regression.html"><code>make_regression</code></a> method.</p>
<p>For reproducibility, we will set a <code>random_state</code>.</p>
<pre style="background-color:#fff"><span style="color:#000;font-weight:bold">import</span> <span style="color:#555">warnings</span>
warnings<span style="color:#000;font-weight:bold">.</span>filterwarnings(<span style="color:#d14">&#39;ignore&#39;</span>)
warnings<span style="color:#000;font-weight:bold">.</span>simplefilter(<span style="color:#d14">&#39;ignore&#39;</span>)

random_state <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">23</span>
</pre><p>We will create a dataset using <code>make_regression</code>'s random linear regression model with input features <span class="math inline">\(x=(f_1,f_2,f_3,f_4)\)</span> and an output <span class="math inline">\(y\)</span>.</p>
<pre style="background-color:#fff"><span style="color:#000;font-weight:bold">import</span> <span style="color:#555">matplotlib.pyplot</span> <span style="color:#000;font-weight:bold">as</span> <span style="color:#555">plt</span>
<span style="color:#000;font-weight:bold">import</span> <span style="color:#555">numpy</span> <span style="color:#000;font-weight:bold">as</span> <span style="color:#555">np</span>
<span style="color:#000;font-weight:bold">import</span> <span style="color:#555">pandas</span> <span style="color:#000;font-weight:bold">as</span> <span style="color:#555">pd</span>
<span style="color:#000;font-weight:bold">from</span> <span style="color:#555">sklearn.datasets</span> <span style="color:#000;font-weight:bold">import</span> make_regression

N_FEATURES <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">4</span>
N_TARGETS <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">1</span>
N_SAMPLES <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">100</span>

dataset <span style="color:#000;font-weight:bold">=</span> make_regression(
    n_samples<span style="color:#000;font-weight:bold">=</span>N_SAMPLES,
    n_features<span style="color:#000;font-weight:bold">=</span>N_FEATURES,
    n_informative<span style="color:#000;font-weight:bold">=</span><span style="color:#099">2</span>,
    n_targets<span style="color:#000;font-weight:bold">=</span>N_TARGETS,
    bias<span style="color:#000;font-weight:bold">=</span><span style="color:#099">0.0</span>,
    effective_rank<span style="color:#000;font-weight:bold">=</span><span style="color:#999">None</span>,
    tail_strength<span style="color:#000;font-weight:bold">=</span><span style="color:#099">0.5</span>,
    noise<span style="color:#000;font-weight:bold">=</span><span style="color:#099">0.0</span>,
    shuffle<span style="color:#000;font-weight:bold">=</span><span style="color:#999">True</span>,
    coef<span style="color:#000;font-weight:bold">=</span><span style="color:#999">False</span>,
    random_state<span style="color:#000;font-weight:bold">=</span>random_state,
)

<span style="color:#000;font-weight:bold">print</span>(dataset[<span style="color:#099">0</span>][:<span style="color:#099">10</span>])
<span style="color:#000;font-weight:bold">print</span>(dataset[<span style="color:#099">1</span>][:<span style="color:#099">10</span>])
</pre><pre><code>[[ 0.87305874 -1.63096187  0.52538404 -0.19035824]
 [ 1.00698671  0.79834941 -0.04057655 -0.31358605]
 [-0.61464273  1.65110321  0.75791487 -0.0039844 ]
 [-1.08536678  1.82337823  0.4612592  -1.72325306]
 [-1.67774847 -0.54401341  0.86347869 -0.30250463]
 [-0.02427254  0.75537599 -0.04644972 -0.85153564]
 [-0.48085576  0.82100952 -0.9390196  -0.25870492]
 [-0.66772841 -2.46244005 -0.19855095 -1.85756579]
 [-0.29810663 -0.02239635  0.25363492 -1.22688366]
 [ 1.48146924  0.38269965 -1.18208819 -1.31062148]]
[  20.00449025  -30.41054677   52.65371365 -119.26376184   33.78805456
  -78.12189078  -88.41673748 -177.21674804  -90.13920313 -197.90799195]
</code></pre>
<p>Let's turn this dataset into a Pandas <code>DataFrame</code>:</p>
<pre style="background-color:#fff">df <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>DataFrame(data<span style="color:#000;font-weight:bold">=</span>dataset[<span style="color:#099">0</span>], columns<span style="color:#000;font-weight:bold">=</span>[f<span style="color:#d14">&#34;f{i+1}&#34;</span> <span style="color:#000;font-weight:bold">for</span> i <span style="color:#000;font-weight:bold">in</span> <span style="color:#0086b3">range</span>(N_FEATURES)])

df[<span style="color:#d14">&#34;y&#34;</span>] <span style="color:#000;font-weight:bold">=</span> dataset[<span style="color:#099">1</span>]
</pre><pre style="background-color:#fff">df<span style="color:#000;font-weight:bold">.</span>head()
</pre><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>f1</th>
      <th>f2</th>
      <th>f3</th>
      <th>f4</th>
      <th>y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.873059</td>
      <td>-1.630962</td>
      <td>0.525384</td>
      <td>-0.190358</td>
      <td>20.004490</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.006987</td>
      <td>0.798349</td>
      <td>-0.040577</td>
      <td>-0.313586</td>
      <td>-30.410547</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.614643</td>
      <td>1.651103</td>
      <td>0.757915</td>
      <td>-0.003984</td>
      <td>52.653714</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-1.085367</td>
      <td>1.823378</td>
      <td>0.461259</td>
      <td>-1.723253</td>
      <td>-119.263762</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-1.677748</td>
      <td>-0.544013</td>
      <td>0.863479</td>
      <td>-0.302505</td>
      <td>33.788055</td>
    </tr>
  </tbody>
</table>
</div>
<p>Let's plot the data:</p>
<pre style="background-color:#fff"><span style="color:#000;font-weight:bold">from</span> <span style="color:#555">plotutils</span> <span style="color:#000;font-weight:bold">import</span> <span style="color:#000;font-weight:bold">*</span>


<span style="color:#000;font-weight:bold">def</span> <span style="color:#900;font-weight:bold">plot_regression</span>(df, size):
    <span style="color:#000;font-weight:bold">for</span> i <span style="color:#000;font-weight:bold">in</span> <span style="color:#0086b3">range</span>(size):
        fit <span style="color:#000;font-weight:bold">=</span> np<span style="color:#000;font-weight:bold">.</span>polyfit(df[df<span style="color:#000;font-weight:bold">.</span>columns[i]], df[<span style="color:#d14">&#34;y&#34;</span>], <span style="color:#099">1</span>)
        fit_fn <span style="color:#000;font-weight:bold">=</span> np<span style="color:#000;font-weight:bold">.</span>poly1d(fit)
        plt<span style="color:#000;font-weight:bold">.</span>subplot(<span style="color:#099">2</span>, <span style="color:#099">2</span>, i <span style="color:#000;font-weight:bold">+</span> <span style="color:#099">1</span>)
        plt<span style="color:#000;font-weight:bold">.</span>xlabel(<span style="color:#d14">&#34;y&#34;</span>)
        plt<span style="color:#000;font-weight:bold">.</span>ylabel(f<span style="color:#d14">&#34;f{i+1}&#34;</span>)
        plt<span style="color:#000;font-weight:bold">.</span>scatter(df[df<span style="color:#000;font-weight:bold">.</span>columns[i]], df[<span style="color:#d14">&#34;y&#34;</span>], s<span style="color:#000;font-weight:bold">=</span><span style="color:#099">30</span>, c<span style="color:#000;font-weight:bold">=</span>colours[<span style="color:#099">1</span>], edgecolor<span style="color:#000;font-weight:bold">=</span>edges[<span style="color:#099">1</span>])
        plt<span style="color:#000;font-weight:bold">.</span>plot(
            df[df<span style="color:#000;font-weight:bold">.</span>columns[i]], fit_fn(df[df<span style="color:#000;font-weight:bold">.</span>columns[i]]), ls<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;--&#34;</span>, c<span style="color:#000;font-weight:bold">=</span>colours[<span style="color:#099">0</span>], lw<span style="color:#000;font-weight:bold">=</span><span style="color:#099">1</span>
        )


plot_regression(df, N_FEATURES)
</pre><p><img src="./figures/Synthetic%20Data%20Generation_9_0.png" alt="png" /></p>
<h3 id="changing-the-gaussian-noise-level">Changing the Gaussian noise level</h3>
<p>The <code>noise</code> parameter in <code>make_regression</code> allows to adjust the scale of the data's gaussian centered noise.</p>
<pre style="background-color:#fff">dataset <span style="color:#000;font-weight:bold">=</span> make_regression(
    n_samples<span style="color:#000;font-weight:bold">=</span>N_SAMPLES,
    n_features<span style="color:#000;font-weight:bold">=</span>N_FEATURES,
    n_informative<span style="color:#000;font-weight:bold">=</span><span style="color:#099">2</span>,
    n_targets<span style="color:#000;font-weight:bold">=</span>N_TARGETS,
    bias<span style="color:#000;font-weight:bold">=</span><span style="color:#099">0.0</span>,
    effective_rank<span style="color:#000;font-weight:bold">=</span><span style="color:#999">None</span>,
    tail_strength<span style="color:#000;font-weight:bold">=</span><span style="color:#099">0.5</span>,
    noise<span style="color:#000;font-weight:bold">=</span><span style="color:#099">2.0</span>,
    shuffle<span style="color:#000;font-weight:bold">=</span><span style="color:#999">True</span>,
    coef<span style="color:#000;font-weight:bold">=</span><span style="color:#999">False</span>,
    random_state<span style="color:#000;font-weight:bold">=</span>random_state,
)

df <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>DataFrame(data<span style="color:#000;font-weight:bold">=</span>dataset[<span style="color:#099">0</span>], columns<span style="color:#000;font-weight:bold">=</span>[f<span style="color:#d14">&#34;f{i+1}&#34;</span> <span style="color:#000;font-weight:bold">for</span> i <span style="color:#000;font-weight:bold">in</span> <span style="color:#0086b3">range</span>(N_FEATURES)])

df[<span style="color:#d14">&#34;y&#34;</span>] <span style="color:#000;font-weight:bold">=</span> dataset[<span style="color:#099">1</span>]
</pre><pre style="background-color:#fff">plot_regression(df, N_FEATURES)
</pre><p><img src="./figures/Synthetic%20Data%20Generation_13_0.png" alt="png" /></p>
<h3 id="visualising-increasing-noise">Visualising increasing noise</h3>
<p>Let's increase the noise by <span class="math inline">\(10^i\)</span>, for <span class="math inline">\(i=1, 2, 3\)</span> and see what the data looks like.</p>
<pre style="background-color:#fff">df <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>DataFrame(data<span style="color:#000;font-weight:bold">=</span>np<span style="color:#000;font-weight:bold">.</span>zeros((N_SAMPLES, <span style="color:#099">1</span>)))


<span style="color:#000;font-weight:bold">def</span> <span style="color:#900;font-weight:bold">create_noisy_data</span>(noise):
    <span style="color:#000;font-weight:bold">return</span> make_regression(
        n_samples<span style="color:#000;font-weight:bold">=</span>N_SAMPLES,
        n_features<span style="color:#000;font-weight:bold">=</span><span style="color:#099">1</span>,
        n_informative<span style="color:#000;font-weight:bold">=</span><span style="color:#099">1</span>,
        n_targets<span style="color:#000;font-weight:bold">=</span><span style="color:#099">1</span>,
        bias<span style="color:#000;font-weight:bold">=</span><span style="color:#099">0.0</span>,
        effective_rank<span style="color:#000;font-weight:bold">=</span><span style="color:#999">None</span>,
        tail_strength<span style="color:#000;font-weight:bold">=</span><span style="color:#099">0.5</span>,
        noise<span style="color:#000;font-weight:bold">=</span>noise,
        shuffle<span style="color:#000;font-weight:bold">=</span><span style="color:#999">True</span>,
        coef<span style="color:#000;font-weight:bold">=</span><span style="color:#999">False</span>,
        random_state<span style="color:#000;font-weight:bold">=</span>random_state,
    )


<span style="color:#000;font-weight:bold">for</span> i <span style="color:#000;font-weight:bold">in</span> <span style="color:#0086b3">range</span>(<span style="color:#099">3</span>):
    data <span style="color:#000;font-weight:bold">=</span> create_noisy_data(<span style="color:#099">10</span> <span style="color:#000;font-weight:bold">**</span> i)

    df[f<span style="color:#d14">&#34;f{i+1}&#34;</span>] <span style="color:#000;font-weight:bold">=</span> data[<span style="color:#099">0</span>]
    df[f<span style="color:#d14">&#34;y{i+1}&#34;</span>] <span style="color:#000;font-weight:bold">=</span> data[<span style="color:#099">1</span>]
</pre><pre style="background-color:#fff"><span style="color:#000;font-weight:bold">for</span> i <span style="color:#000;font-weight:bold">in</span> <span style="color:#0086b3">range</span>(<span style="color:#099">3</span>):
    fit <span style="color:#000;font-weight:bold">=</span> np<span style="color:#000;font-weight:bold">.</span>polyfit(df[f<span style="color:#d14">&#34;f{i+1}&#34;</span>], df[f<span style="color:#d14">&#34;y{i+1}&#34;</span>], <span style="color:#099">1</span>)
    fit_fn <span style="color:#000;font-weight:bold">=</span> np<span style="color:#000;font-weight:bold">.</span>poly1d(fit)
    plt<span style="color:#000;font-weight:bold">.</span>subplot(<span style="color:#099">1</span>, <span style="color:#099">3</span>, i <span style="color:#000;font-weight:bold">+</span> <span style="color:#099">1</span>)
    plt<span style="color:#000;font-weight:bold">.</span>scatter(df[f<span style="color:#d14">&#34;f{i+1}&#34;</span>], df[f<span style="color:#d14">&#34;y{i+1}&#34;</span>], s<span style="color:#000;font-weight:bold">=</span><span style="color:#099">30</span>, c<span style="color:#000;font-weight:bold">=</span>colours[<span style="color:#099">1</span>], edgecolor<span style="color:#000;font-weight:bold">=</span>edges[<span style="color:#099">1</span>])
    plt<span style="color:#000;font-weight:bold">.</span>plot(
        df[f<span style="color:#d14">&#34;f{i+1}&#34;</span>],
        fit_fn(df[f<span style="color:#d14">&#34;f{i+1}&#34;</span>]),
        ls<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;--&#34;</span>,
        color<span style="color:#000;font-weight:bold">=</span>colours[<span style="color:#099">0</span>],
        lw<span style="color:#000;font-weight:bold">=</span><span style="color:#099">1</span>,
    )
    plt<span style="color:#000;font-weight:bold">.</span>xlabel(f<span style="color:#d14">&#34;f{i+1}&#34;</span>)
    plt<span style="color:#000;font-weight:bold">.</span>ylabel(f<span style="color:#d14">&#34;y{i+1}&#34;</span>)
</pre><p><img src="./figures/Synthetic%20Data%20Generation_16_0.png" alt="png" /></p>
<p>(data:classification)=</p>
<h2 id="classification-data">Classification data</h2>
<p>To generate data for classification we will use the <a href="https://scikit-learn.org/stable/modules/generated/sklearn.datasets.make_classification.html"><code>make_classification</code></a> method.</p>
<pre style="background-color:#fff"><span style="color:#000;font-weight:bold">from</span> <span style="color:#555">sklearn.datasets</span> <span style="color:#000;font-weight:bold">import</span> make_classification

N <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">4</span>

data <span style="color:#000;font-weight:bold">=</span> make_classification(
    n_samples<span style="color:#000;font-weight:bold">=</span>N_SAMPLES,
    n_features<span style="color:#000;font-weight:bold">=</span>N,
    n_informative<span style="color:#000;font-weight:bold">=</span><span style="color:#099">4</span>,
    n_redundant<span style="color:#000;font-weight:bold">=</span><span style="color:#099">0</span>,
    n_repeated<span style="color:#000;font-weight:bold">=</span><span style="color:#099">0</span>,
    n_classes<span style="color:#000;font-weight:bold">=</span><span style="color:#099">2</span>,
    n_clusters_per_class<span style="color:#000;font-weight:bold">=</span><span style="color:#099">1</span>,
    weights<span style="color:#000;font-weight:bold">=</span><span style="color:#999">None</span>,
    flip_y<span style="color:#000;font-weight:bold">=</span><span style="color:#099">0.01</span>,
    class_sep<span style="color:#000;font-weight:bold">=</span><span style="color:#099">1.0</span>,
    hypercube<span style="color:#000;font-weight:bold">=</span><span style="color:#999">True</span>,
    shift<span style="color:#000;font-weight:bold">=</span><span style="color:#099">0.0</span>,
    scale<span style="color:#000;font-weight:bold">=</span><span style="color:#099">1.0</span>,
    shuffle<span style="color:#000;font-weight:bold">=</span><span style="color:#999">True</span>,
    random_state<span style="color:#000;font-weight:bold">=</span>random_state,
)

df <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>DataFrame(data[<span style="color:#099">0</span>], columns<span style="color:#000;font-weight:bold">=</span>[f<span style="color:#d14">&#34;f{i+1}&#34;</span> <span style="color:#000;font-weight:bold">for</span> i <span style="color:#000;font-weight:bold">in</span> <span style="color:#0086b3">range</span>(N)])

df[<span style="color:#d14">&#34;y&#34;</span>] <span style="color:#000;font-weight:bold">=</span> data[<span style="color:#099">1</span>]
</pre><pre style="background-color:#fff">df<span style="color:#000;font-weight:bold">.</span>head()
</pre><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>f1</th>
      <th>f2</th>
      <th>f3</th>
      <th>f4</th>
      <th>y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-3.216</td>
      <td>-0.416</td>
      <td>-1.295</td>
      <td>-1.882</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-1.426</td>
      <td>-1.257</td>
      <td>-1.734</td>
      <td>-1.804</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2.798</td>
      <td>-3.010</td>
      <td>-1.085</td>
      <td>-3.134</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.633</td>
      <td>2.502</td>
      <td>-1.553</td>
      <td>1.625</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.494</td>
      <td>0.912</td>
      <td>-1.887</td>
      <td>-1.457</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
<pre style="background-color:#fff"><span style="color:#000;font-weight:bold">from</span> <span style="color:#555">itertools</span> <span style="color:#000;font-weight:bold">import</span> combinations
<span style="color:#000;font-weight:bold">from</span> <span style="color:#555">math</span> <span style="color:#000;font-weight:bold">import</span> ceil

lst_var <span style="color:#000;font-weight:bold">=</span> <span style="color:#0086b3">list</span>(combinations(df<span style="color:#000;font-weight:bold">.</span>columns[:<span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>], <span style="color:#099">2</span>))
len_var <span style="color:#000;font-weight:bold">=</span> <span style="color:#0086b3">len</span>(lst_var)

<span style="color:#000;font-weight:bold">for</span> i <span style="color:#000;font-weight:bold">in</span> <span style="color:#0086b3">range</span>(<span style="color:#099">1</span>, len_var <span style="color:#000;font-weight:bold">+</span> <span style="color:#099">1</span>):
    plt<span style="color:#000;font-weight:bold">.</span>subplot(<span style="color:#099">2</span>, ceil(len_var <span style="color:#000;font-weight:bold">/</span> <span style="color:#099">2</span>), i)
    var1 <span style="color:#000;font-weight:bold">=</span> lst_var[i <span style="color:#000;font-weight:bold">-</span> <span style="color:#099">1</span>][<span style="color:#099">0</span>]
    var2 <span style="color:#000;font-weight:bold">=</span> lst_var[i <span style="color:#000;font-weight:bold">-</span> <span style="color:#099">1</span>][<span style="color:#099">1</span>]
    plt<span style="color:#000;font-weight:bold">.</span>scatter(
        df[var1],
        df[var2],
        s<span style="color:#000;font-weight:bold">=</span><span style="color:#099">50</span>,
        c<span style="color:#000;font-weight:bold">=</span>df[<span style="color:#d14">&#34;y&#34;</span>]<span style="color:#000;font-weight:bold">.</span>apply(<span style="color:#000;font-weight:bold">lambda</span> y: colours[y]),
        edgecolor<span style="color:#000;font-weight:bold">=</span>df[<span style="color:#d14">&#34;y&#34;</span>]<span style="color:#000;font-weight:bold">.</span>apply(<span style="color:#000;font-weight:bold">lambda</span> y: edges[y]),
    )
    plt<span style="color:#000;font-weight:bold">.</span>xlabel(var1)
    plt<span style="color:#000;font-weight:bold">.</span>ylabel(var2)
</pre><p><img src="./figures/Synthetic%20Data%20Generation_20_0.png" alt="png" /></p>
<h3 id="cluster-separation">Cluster separation</h3>
<p>According to the docs<sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup>, <code>class_sep</code> is the factor multiplying the hypercube size.</p>
<p>Larger values spread out the clusters/classes and make the classification task easier.</p>
<pre style="background-color:#fff">N_FEATURES <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">4</span>

data <span style="color:#000;font-weight:bold">=</span> make_classification(
    n_samples<span style="color:#000;font-weight:bold">=</span>N_SAMPLES,
    n_features<span style="color:#000;font-weight:bold">=</span>N_FEATURES,
    n_informative<span style="color:#000;font-weight:bold">=</span><span style="color:#099">4</span>,
    n_redundant<span style="color:#000;font-weight:bold">=</span><span style="color:#099">0</span>,
    n_repeated<span style="color:#000;font-weight:bold">=</span><span style="color:#099">0</span>,
    n_classes<span style="color:#000;font-weight:bold">=</span><span style="color:#099">2</span>,
    n_clusters_per_class<span style="color:#000;font-weight:bold">=</span><span style="color:#099">1</span>,
    weights<span style="color:#000;font-weight:bold">=</span><span style="color:#999">None</span>,
    flip_y<span style="color:#000;font-weight:bold">=</span><span style="color:#099">0.01</span>,
    class_sep<span style="color:#000;font-weight:bold">=</span><span style="color:#099">3.0</span>,
    hypercube<span style="color:#000;font-weight:bold">=</span><span style="color:#999">True</span>,
    shift<span style="color:#000;font-weight:bold">=</span><span style="color:#099">0.0</span>,
    scale<span style="color:#000;font-weight:bold">=</span><span style="color:#099">1.0</span>,
    shuffle<span style="color:#000;font-weight:bold">=</span><span style="color:#999">True</span>,
    random_state<span style="color:#000;font-weight:bold">=</span><span style="color:#999">None</span>,
)

df <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>DataFrame(data[<span style="color:#099">0</span>], columns<span style="color:#000;font-weight:bold">=</span>[f<span style="color:#d14">&#34;f{i+1}&#34;</span> <span style="color:#000;font-weight:bold">for</span> i <span style="color:#000;font-weight:bold">in</span> <span style="color:#0086b3">range</span>(N_FEATURES)])

df[<span style="color:#d14">&#34;y&#34;</span>] <span style="color:#000;font-weight:bold">=</span> data[<span style="color:#099">1</span>]
</pre><pre style="background-color:#fff"><span style="color:#000;font-weight:bold">from</span> <span style="color:#555">itertools</span> <span style="color:#000;font-weight:bold">import</span> combinations
<span style="color:#000;font-weight:bold">from</span> <span style="color:#555">math</span> <span style="color:#000;font-weight:bold">import</span> ceil

lst_var <span style="color:#000;font-weight:bold">=</span> <span style="color:#0086b3">list</span>(combinations(df<span style="color:#000;font-weight:bold">.</span>columns[:<span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>], <span style="color:#099">2</span>))
len_var <span style="color:#000;font-weight:bold">=</span> <span style="color:#0086b3">len</span>(lst_var)

<span style="color:#000;font-weight:bold">for</span> i <span style="color:#000;font-weight:bold">in</span> <span style="color:#0086b3">range</span>(<span style="color:#099">1</span>, len_var <span style="color:#000;font-weight:bold">+</span> <span style="color:#099">1</span>):
    plt<span style="color:#000;font-weight:bold">.</span>subplot(<span style="color:#099">2</span>, ceil(len_var <span style="color:#000;font-weight:bold">/</span> <span style="color:#099">2</span>), i)
    var1 <span style="color:#000;font-weight:bold">=</span> lst_var[i <span style="color:#000;font-weight:bold">-</span> <span style="color:#099">1</span>][<span style="color:#099">0</span>]
    var2 <span style="color:#000;font-weight:bold">=</span> lst_var[i <span style="color:#000;font-weight:bold">-</span> <span style="color:#099">1</span>][<span style="color:#099">1</span>]
    plt<span style="color:#000;font-weight:bold">.</span>scatter(
        df[var1],
        df[var2],
        s<span style="color:#000;font-weight:bold">=</span><span style="color:#099">50</span>,
        c<span style="color:#000;font-weight:bold">=</span>df[<span style="color:#d14">&#34;y&#34;</span>]<span style="color:#000;font-weight:bold">.</span>apply(<span style="color:#000;font-weight:bold">lambda</span> y: colours[y]),
        edgecolor<span style="color:#000;font-weight:bold">=</span>df[<span style="color:#d14">&#34;y&#34;</span>]<span style="color:#000;font-weight:bold">.</span>apply(<span style="color:#000;font-weight:bold">lambda</span> y: edges[y]),
    )
    plt<span style="color:#000;font-weight:bold">.</span>xlabel(var1)
    plt<span style="color:#000;font-weight:bold">.</span>ylabel(var2)
</pre><p><img src="./figures/Synthetic%20Data%20Generation_23_0.png" alt="png" /></p>
<p>We can make the cluster separability more difficult, by decreasing the value of <code>class_sep</code>.</p>
<pre style="background-color:#fff">N_FEATURES <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">4</span>

data <span style="color:#000;font-weight:bold">=</span> make_classification(
    n_samples<span style="color:#000;font-weight:bold">=</span>N_SAMPLES,
    n_features<span style="color:#000;font-weight:bold">=</span>N_FEATURES,
    n_informative<span style="color:#000;font-weight:bold">=</span><span style="color:#099">4</span>,
    n_redundant<span style="color:#000;font-weight:bold">=</span><span style="color:#099">0</span>,
    n_repeated<span style="color:#000;font-weight:bold">=</span><span style="color:#099">0</span>,
    n_classes<span style="color:#000;font-weight:bold">=</span><span style="color:#099">2</span>,
    n_clusters_per_class<span style="color:#000;font-weight:bold">=</span><span style="color:#099">1</span>,
    weights<span style="color:#000;font-weight:bold">=</span><span style="color:#999">None</span>,
    flip_y<span style="color:#000;font-weight:bold">=</span><span style="color:#099">0.01</span>,
    class_sep<span style="color:#000;font-weight:bold">=</span><span style="color:#099">0.5</span>,
    hypercube<span style="color:#000;font-weight:bold">=</span><span style="color:#999">True</span>,
    shift<span style="color:#000;font-weight:bold">=</span><span style="color:#099">0.0</span>,
    scale<span style="color:#000;font-weight:bold">=</span><span style="color:#099">1.0</span>,
    shuffle<span style="color:#000;font-weight:bold">=</span><span style="color:#999">True</span>,
    random_state<span style="color:#000;font-weight:bold">=</span><span style="color:#999">None</span>,
)

df <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>DataFrame(data[<span style="color:#099">0</span>], columns<span style="color:#000;font-weight:bold">=</span>[f<span style="color:#d14">&#34;f{i+1}&#34;</span> <span style="color:#000;font-weight:bold">for</span> i <span style="color:#000;font-weight:bold">in</span> <span style="color:#0086b3">range</span>(N_FEATURES)])

df[<span style="color:#d14">&#34;y&#34;</span>] <span style="color:#000;font-weight:bold">=</span> data[<span style="color:#099">1</span>]
</pre><pre style="background-color:#fff"><span style="color:#000;font-weight:bold">from</span> <span style="color:#555">itertools</span> <span style="color:#000;font-weight:bold">import</span> combinations
<span style="color:#000;font-weight:bold">from</span> <span style="color:#555">math</span> <span style="color:#000;font-weight:bold">import</span> ceil

lst_var <span style="color:#000;font-weight:bold">=</span> <span style="color:#0086b3">list</span>(combinations(df<span style="color:#000;font-weight:bold">.</span>columns[:<span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>], <span style="color:#099">2</span>))
len_var <span style="color:#000;font-weight:bold">=</span> <span style="color:#0086b3">len</span>(lst_var)

<span style="color:#000;font-weight:bold">for</span> i <span style="color:#000;font-weight:bold">in</span> <span style="color:#0086b3">range</span>(<span style="color:#099">1</span>, len_var <span style="color:#000;font-weight:bold">+</span> <span style="color:#099">1</span>):
    plt<span style="color:#000;font-weight:bold">.</span>subplot(<span style="color:#099">2</span>, ceil(len_var <span style="color:#000;font-weight:bold">/</span> <span style="color:#099">2</span>), i)
    var1 <span style="color:#000;font-weight:bold">=</span> lst_var[i <span style="color:#000;font-weight:bold">-</span> <span style="color:#099">1</span>][<span style="color:#099">0</span>]
    var2 <span style="color:#000;font-weight:bold">=</span> lst_var[i <span style="color:#000;font-weight:bold">-</span> <span style="color:#099">1</span>][<span style="color:#099">1</span>]
    plt<span style="color:#000;font-weight:bold">.</span>scatter(
        df[var1],
        df[var2],
        s<span style="color:#000;font-weight:bold">=</span><span style="color:#099">50</span>,
        c<span style="color:#000;font-weight:bold">=</span>df[<span style="color:#d14">&#34;y&#34;</span>]<span style="color:#000;font-weight:bold">.</span>apply(<span style="color:#000;font-weight:bold">lambda</span> y: colours[y]),
        edgecolor<span style="color:#000;font-weight:bold">=</span>df[<span style="color:#d14">&#34;y&#34;</span>]<span style="color:#000;font-weight:bold">.</span>apply(<span style="color:#000;font-weight:bold">lambda</span> y: edges[y]),
    )
    plt<span style="color:#000;font-weight:bold">.</span>xlabel(var1)
    plt<span style="color:#000;font-weight:bold">.</span>ylabel(var2)
</pre><p><img src="./figures/Synthetic%20Data%20Generation_26_0.png" alt="png" /></p>
<h3 id="noise-level">Noise level</h3>
<p>According to the documentation<sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup>, <code>flip_y</code> is the fraction of samples whose class is assigned randomly.</p>
<p>Larger values introduce noise in the labels and make the classification task harder.</p>
<pre style="background-color:#fff">N_FEATURES <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">4</span>


<span style="color:#000;font-weight:bold">for</span> i <span style="color:#000;font-weight:bold">in</span> <span style="color:#0086b3">range</span>(<span style="color:#099">6</span>):
    data <span style="color:#000;font-weight:bold">=</span> make_classification(
        n_samples<span style="color:#000;font-weight:bold">=</span>N_SAMPLES,
        n_features<span style="color:#000;font-weight:bold">=</span>N_FEATURES,
        n_informative<span style="color:#000;font-weight:bold">=</span><span style="color:#099">4</span>,
        n_redundant<span style="color:#000;font-weight:bold">=</span><span style="color:#099">0</span>,
        n_repeated<span style="color:#000;font-weight:bold">=</span><span style="color:#099">0</span>,
        n_classes<span style="color:#000;font-weight:bold">=</span><span style="color:#099">2</span>,
        n_clusters_per_class<span style="color:#000;font-weight:bold">=</span><span style="color:#099">1</span>,
        weights<span style="color:#000;font-weight:bold">=</span><span style="color:#999">None</span>,
        flip_y<span style="color:#000;font-weight:bold">=</span><span style="color:#099">0.1</span> <span style="color:#000;font-weight:bold">*</span> i,
        class_sep<span style="color:#000;font-weight:bold">=</span><span style="color:#099">1.0</span>,
        hypercube<span style="color:#000;font-weight:bold">=</span><span style="color:#999">True</span>,
        shift<span style="color:#000;font-weight:bold">=</span><span style="color:#099">0.0</span>,
        scale<span style="color:#000;font-weight:bold">=</span><span style="color:#099">1.0</span>,
        shuffle<span style="color:#000;font-weight:bold">=</span><span style="color:#999">False</span>,
        random_state<span style="color:#000;font-weight:bold">=</span>random_state,
    )
    df <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>DataFrame(data[<span style="color:#099">0</span>], columns<span style="color:#000;font-weight:bold">=</span>[f<span style="color:#d14">&#34;f{i+1}&#34;</span> <span style="color:#000;font-weight:bold">for</span> i <span style="color:#000;font-weight:bold">in</span> <span style="color:#0086b3">range</span>(N_FEATURES)])
    df[<span style="color:#d14">&#34;y&#34;</span>] <span style="color:#000;font-weight:bold">=</span> data[<span style="color:#099">1</span>]
    plt<span style="color:#000;font-weight:bold">.</span>subplot(<span style="color:#099">2</span>, <span style="color:#099">3</span>, i <span style="color:#000;font-weight:bold">+</span> <span style="color:#099">1</span>)
    plt<span style="color:#000;font-weight:bold">.</span>title(f<span style="color:#d14">&#34;flip_y={round(0.1*i,2)}&#34;</span>)
    plt<span style="color:#000;font-weight:bold">.</span>scatter(
        df[<span style="color:#d14">&#34;f1&#34;</span>],
        df[<span style="color:#d14">&#34;f2&#34;</span>],
        s<span style="color:#000;font-weight:bold">=</span><span style="color:#099">50</span>,
        c<span style="color:#000;font-weight:bold">=</span>df[<span style="color:#d14">&#34;y&#34;</span>]<span style="color:#000;font-weight:bold">.</span>apply(<span style="color:#000;font-weight:bold">lambda</span> y: colours[y]),
        edgecolor<span style="color:#000;font-weight:bold">=</span>df[<span style="color:#d14">&#34;y&#34;</span>]<span style="color:#000;font-weight:bold">.</span>apply(<span style="color:#000;font-weight:bold">lambda</span> y: edges[y]),
    )
plt<span style="color:#000;font-weight:bold">.</span>tight_layout(pad<span style="color:#000;font-weight:bold">=</span><span style="color:#099">3.0</span>)
</pre><p><img src="./figures/Synthetic%20Data%20Generation_28_0.png" alt="png" /></p>
<pre style="background-color:#fff">df <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>DataFrame(data<span style="color:#000;font-weight:bold">=</span>np<span style="color:#000;font-weight:bold">.</span>zeros((N_SAMPLES, <span style="color:#099">1</span>)))

<span style="color:#000;font-weight:bold">for</span> i <span style="color:#000;font-weight:bold">in</span> <span style="color:#0086b3">range</span>(<span style="color:#099">3</span>):
    data <span style="color:#000;font-weight:bold">=</span> make_classification(
        n_samples<span style="color:#000;font-weight:bold">=</span>N_SAMPLES,
        n_features<span style="color:#000;font-weight:bold">=</span><span style="color:#099">2</span>,
        n_informative<span style="color:#000;font-weight:bold">=</span><span style="color:#099">2</span>,
        n_redundant<span style="color:#000;font-weight:bold">=</span><span style="color:#099">0</span>,
        n_repeated<span style="color:#000;font-weight:bold">=</span><span style="color:#099">0</span>,
        n_classes<span style="color:#000;font-weight:bold">=</span><span style="color:#099">2</span>,
        n_clusters_per_class<span style="color:#000;font-weight:bold">=</span><span style="color:#099">1</span>,
        weights<span style="color:#000;font-weight:bold">=</span><span style="color:#999">None</span>,
        flip_y<span style="color:#000;font-weight:bold">=</span><span style="color:#099">0</span>,
        class_sep<span style="color:#000;font-weight:bold">=</span>i <span style="color:#000;font-weight:bold">+</span> <span style="color:#099">0.5</span>,
        hypercube<span style="color:#000;font-weight:bold">=</span><span style="color:#999">True</span>,
        shift<span style="color:#000;font-weight:bold">=</span><span style="color:#099">0.0</span>,
        scale<span style="color:#000;font-weight:bold">=</span><span style="color:#099">1.0</span>,
        shuffle<span style="color:#000;font-weight:bold">=</span><span style="color:#999">False</span>,
        random_state<span style="color:#000;font-weight:bold">=</span>random_state,
    )
    df[f<span style="color:#d14">&#34;f{i+1}1&#34;</span>] <span style="color:#000;font-weight:bold">=</span> data[<span style="color:#099">0</span>][:, <span style="color:#099">0</span>]
    df[f<span style="color:#d14">&#34;f{i+1}2&#34;</span>] <span style="color:#000;font-weight:bold">=</span> data[<span style="color:#099">0</span>][:, <span style="color:#099">1</span>]
    df[f<span style="color:#d14">&#34;t{i+1}&#34;</span>] <span style="color:#000;font-weight:bold">=</span> data[<span style="color:#099">1</span>]

<span style="color:#000;font-weight:bold">for</span> i <span style="color:#000;font-weight:bold">in</span> <span style="color:#0086b3">range</span>(<span style="color:#099">3</span>):
    plt<span style="color:#000;font-weight:bold">.</span>subplot(<span style="color:#099">1</span>, <span style="color:#099">3</span>, i <span style="color:#000;font-weight:bold">+</span> <span style="color:#099">1</span>)
    plt<span style="color:#000;font-weight:bold">.</span>scatter(
        df[f<span style="color:#d14">&#34;f{i+1}1&#34;</span>],
        df[f<span style="color:#d14">&#34;f{i+1}2&#34;</span>],
        s<span style="color:#000;font-weight:bold">=</span><span style="color:#099">50</span>,
        c<span style="color:#000;font-weight:bold">=</span>df[f<span style="color:#d14">&#34;t{i+1}&#34;</span>]<span style="color:#000;font-weight:bold">.</span>apply(<span style="color:#000;font-weight:bold">lambda</span> y: colours[y]),
        edgecolor<span style="color:#000;font-weight:bold">=</span>df[f<span style="color:#d14">&#34;t{i+1}&#34;</span>]<span style="color:#000;font-weight:bold">.</span>apply(<span style="color:#000;font-weight:bold">lambda</span> y: edges[y]),
    )
</pre><p><img src="./figures/Synthetic%20Data%20Generation_29_0.png" alt="png" /></p>
<h2 id="separability">Separability</h2>
<pre style="background-color:#fff"><span style="color:#000;font-weight:bold">from</span> <span style="color:#555">sklearn.datasets</span> <span style="color:#000;font-weight:bold">import</span> make_blobs

N_FEATURE <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">4</span>

data <span style="color:#000;font-weight:bold">=</span> make_blobs(
    n_samples<span style="color:#000;font-weight:bold">=</span><span style="color:#099">60</span>,
    n_features<span style="color:#000;font-weight:bold">=</span>N_FEATURE,
    centers<span style="color:#000;font-weight:bold">=</span><span style="color:#099">3</span>,
    cluster_std<span style="color:#000;font-weight:bold">=</span><span style="color:#099">1.0</span>,
    center_box<span style="color:#000;font-weight:bold">=</span>(<span style="color:#000;font-weight:bold">-</span><span style="color:#099">5.0</span>, <span style="color:#099">5.0</span>),
    shuffle<span style="color:#000;font-weight:bold">=</span><span style="color:#999">True</span>,
    random_state<span style="color:#000;font-weight:bold">=</span><span style="color:#999">None</span>,
)
df <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>DataFrame(data[<span style="color:#099">0</span>], columns<span style="color:#000;font-weight:bold">=</span>[f<span style="color:#d14">&#34;f{i+1}&#34;</span> <span style="color:#000;font-weight:bold">for</span> i <span style="color:#000;font-weight:bold">in</span> <span style="color:#0086b3">range</span>(N_FEATURE)])
df[<span style="color:#d14">&#34;y&#34;</span>] <span style="color:#000;font-weight:bold">=</span> data[<span style="color:#099">1</span>]
</pre><pre style="background-color:#fff"><span style="color:#000;font-weight:bold">from</span> <span style="color:#555">itertools</span> <span style="color:#000;font-weight:bold">import</span> combinations
<span style="color:#000;font-weight:bold">from</span> <span style="color:#555">math</span> <span style="color:#000;font-weight:bold">import</span> ceil

lst_var <span style="color:#000;font-weight:bold">=</span> <span style="color:#0086b3">list</span>(combinations(df<span style="color:#000;font-weight:bold">.</span>columns[:<span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>], <span style="color:#099">2</span>))
len_var <span style="color:#000;font-weight:bold">=</span> <span style="color:#0086b3">len</span>(lst_var)
<span style="color:#000;font-weight:bold">for</span> i <span style="color:#000;font-weight:bold">in</span> <span style="color:#0086b3">range</span>(<span style="color:#099">1</span>, len_var <span style="color:#000;font-weight:bold">+</span> <span style="color:#099">1</span>):
    plt<span style="color:#000;font-weight:bold">.</span>subplot(<span style="color:#099">2</span>, ceil(len_var <span style="color:#000;font-weight:bold">/</span> <span style="color:#099">2</span>), i)
    var1 <span style="color:#000;font-weight:bold">=</span> lst_var[i <span style="color:#000;font-weight:bold">-</span> <span style="color:#099">1</span>][<span style="color:#099">0</span>]
    var2 <span style="color:#000;font-weight:bold">=</span> lst_var[i <span style="color:#000;font-weight:bold">-</span> <span style="color:#099">1</span>][<span style="color:#099">1</span>]
    plt<span style="color:#000;font-weight:bold">.</span>scatter(
        df[var1],
        df[var2],
        s<span style="color:#000;font-weight:bold">=</span><span style="color:#099">50</span>,
        c<span style="color:#000;font-weight:bold">=</span>df[<span style="color:#d14">&#34;y&#34;</span>]<span style="color:#000;font-weight:bold">.</span>apply(<span style="color:#000;font-weight:bold">lambda</span> y: colours[y]),
        edgecolor<span style="color:#000;font-weight:bold">=</span>df[<span style="color:#d14">&#34;y&#34;</span>]<span style="color:#000;font-weight:bold">.</span>apply(<span style="color:#000;font-weight:bold">lambda</span> y: edges[y]),
    )
    plt<span style="color:#000;font-weight:bold">.</span>xlabel(var1)
    plt<span style="color:#000;font-weight:bold">.</span>ylabel(var2)
</pre><p><img src="./figures/Synthetic%20Data%20Generation_32_0.png" alt="png" /></p>
<p>To make a cluster more separable we can change <code>cluster_std</code>.</p>
<pre style="background-color:#fff">data <span style="color:#000;font-weight:bold">=</span> make_blobs(
    n_samples<span style="color:#000;font-weight:bold">=</span><span style="color:#099">60</span>,
    n_features<span style="color:#000;font-weight:bold">=</span>N_FEATURES,
    centers<span style="color:#000;font-weight:bold">=</span><span style="color:#099">3</span>,
    cluster_std<span style="color:#000;font-weight:bold">=</span><span style="color:#099">0.3</span>,
    center_box<span style="color:#000;font-weight:bold">=</span>(<span style="color:#000;font-weight:bold">-</span><span style="color:#099">5.0</span>, <span style="color:#099">5.0</span>),
    shuffle<span style="color:#000;font-weight:bold">=</span><span style="color:#999">True</span>,
    random_state<span style="color:#000;font-weight:bold">=</span><span style="color:#999">None</span>,
)
df <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>DataFrame(data[<span style="color:#099">0</span>], columns<span style="color:#000;font-weight:bold">=</span>[f<span style="color:#d14">&#34;f{i+1}&#34;</span> <span style="color:#000;font-weight:bold">for</span> i <span style="color:#000;font-weight:bold">in</span> <span style="color:#0086b3">range</span>(N_FEATURES)])
df[<span style="color:#d14">&#34;y&#34;</span>] <span style="color:#000;font-weight:bold">=</span> data[<span style="color:#099">1</span>]
</pre><pre style="background-color:#fff"><span style="color:#000;font-weight:bold">from</span> <span style="color:#555">itertools</span> <span style="color:#000;font-weight:bold">import</span> combinations
<span style="color:#000;font-weight:bold">from</span> <span style="color:#555">math</span> <span style="color:#000;font-weight:bold">import</span> ceil

lst_var <span style="color:#000;font-weight:bold">=</span> <span style="color:#0086b3">list</span>(combinations(df<span style="color:#000;font-weight:bold">.</span>columns[:<span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>], <span style="color:#099">2</span>))
len_var <span style="color:#000;font-weight:bold">=</span> <span style="color:#0086b3">len</span>(lst_var)
<span style="color:#000;font-weight:bold">for</span> i <span style="color:#000;font-weight:bold">in</span> <span style="color:#0086b3">range</span>(<span style="color:#099">1</span>, len_var <span style="color:#000;font-weight:bold">+</span> <span style="color:#099">1</span>):
    plt<span style="color:#000;font-weight:bold">.</span>subplot(<span style="color:#099">2</span>, ceil(len_var <span style="color:#000;font-weight:bold">/</span> <span style="color:#099">2</span>), i)
    var1 <span style="color:#000;font-weight:bold">=</span> lst_var[i <span style="color:#000;font-weight:bold">-</span> <span style="color:#099">1</span>][<span style="color:#099">0</span>]
    var2 <span style="color:#000;font-weight:bold">=</span> lst_var[i <span style="color:#000;font-weight:bold">-</span> <span style="color:#099">1</span>][<span style="color:#099">1</span>]
    plt<span style="color:#000;font-weight:bold">.</span>scatter(
        df[var1],
        df[var2],
        s<span style="color:#000;font-weight:bold">=</span><span style="color:#099">50</span>,
        c<span style="color:#000;font-weight:bold">=</span>df[<span style="color:#d14">&#34;y&#34;</span>]<span style="color:#000;font-weight:bold">.</span>apply(<span style="color:#000;font-weight:bold">lambda</span> y: colours[y]),
        edgecolor<span style="color:#000;font-weight:bold">=</span>df[<span style="color:#d14">&#34;y&#34;</span>]<span style="color:#000;font-weight:bold">.</span>apply(<span style="color:#000;font-weight:bold">lambda</span> y: edges[y]),
    )
    plt<span style="color:#000;font-weight:bold">.</span>xlabel(var1)
    plt<span style="color:#000;font-weight:bold">.</span>ylabel(var2)
</pre><p><img src="./figures/Synthetic%20Data%20Generation_35_0.png" alt="png" /></p>
<p>By decreasing <code>cluster_std</code> we make them less separable.</p>
<pre style="background-color:#fff">data <span style="color:#000;font-weight:bold">=</span> make_blobs(
    n_samples<span style="color:#000;font-weight:bold">=</span><span style="color:#099">60</span>,
    n_features<span style="color:#000;font-weight:bold">=</span>N_FEATURES,
    centers<span style="color:#000;font-weight:bold">=</span><span style="color:#099">3</span>,
    cluster_std<span style="color:#000;font-weight:bold">=</span><span style="color:#099">2.5</span>,
    center_box<span style="color:#000;font-weight:bold">=</span>(<span style="color:#000;font-weight:bold">-</span><span style="color:#099">5.0</span>, <span style="color:#099">5.0</span>),
    shuffle<span style="color:#000;font-weight:bold">=</span><span style="color:#999">True</span>,
    random_state<span style="color:#000;font-weight:bold">=</span><span style="color:#999">None</span>,
)
df <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>DataFrame(data[<span style="color:#099">0</span>], columns<span style="color:#000;font-weight:bold">=</span>[f<span style="color:#d14">&#34;f{i+1}&#34;</span> <span style="color:#000;font-weight:bold">for</span> i <span style="color:#000;font-weight:bold">in</span> <span style="color:#0086b3">range</span>(N_FEATURES)])
df[<span style="color:#d14">&#34;y&#34;</span>] <span style="color:#000;font-weight:bold">=</span> data[<span style="color:#099">1</span>]
</pre><pre style="background-color:#fff"><span style="color:#000;font-weight:bold">from</span> <span style="color:#555">itertools</span> <span style="color:#000;font-weight:bold">import</span> combinations
<span style="color:#000;font-weight:bold">from</span> <span style="color:#555">math</span> <span style="color:#000;font-weight:bold">import</span> ceil

lst_var <span style="color:#000;font-weight:bold">=</span> <span style="color:#0086b3">list</span>(combinations(df<span style="color:#000;font-weight:bold">.</span>columns[:<span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>], <span style="color:#099">2</span>))
len_var <span style="color:#000;font-weight:bold">=</span> <span style="color:#0086b3">len</span>(lst_var)
<span style="color:#000;font-weight:bold">for</span> i <span style="color:#000;font-weight:bold">in</span> <span style="color:#0086b3">range</span>(<span style="color:#099">1</span>, len_var <span style="color:#000;font-weight:bold">+</span> <span style="color:#099">1</span>):
    plt<span style="color:#000;font-weight:bold">.</span>subplot(<span style="color:#099">2</span>, ceil(len_var <span style="color:#000;font-weight:bold">/</span> <span style="color:#099">2</span>), i)
    var1 <span style="color:#000;font-weight:bold">=</span> lst_var[i <span style="color:#000;font-weight:bold">-</span> <span style="color:#099">1</span>][<span style="color:#099">0</span>]
    var2 <span style="color:#000;font-weight:bold">=</span> lst_var[i <span style="color:#000;font-weight:bold">-</span> <span style="color:#099">1</span>][<span style="color:#099">1</span>]
    plt<span style="color:#000;font-weight:bold">.</span>scatter(
        df[var1],
        df[var2],
        s<span style="color:#000;font-weight:bold">=</span><span style="color:#099">50</span>,
        c<span style="color:#000;font-weight:bold">=</span>df[<span style="color:#d14">&#34;y&#34;</span>]<span style="color:#000;font-weight:bold">.</span>apply(<span style="color:#000;font-weight:bold">lambda</span> y: colours[y]),
        edgecolor<span style="color:#000;font-weight:bold">=</span>df[<span style="color:#d14">&#34;y&#34;</span>]<span style="color:#000;font-weight:bold">.</span>apply(<span style="color:#000;font-weight:bold">lambda</span> y: edges[y]),
    )
    plt<span style="color:#000;font-weight:bold">.</span>xlabel(var1)
    plt<span style="color:#000;font-weight:bold">.</span>ylabel(var2)
</pre><p><img src="./figures/Synthetic%20Data%20Generation_38_0.png" alt="png" /></p>
<h3 id="anisotropic-data">Anisotropic data</h3>
<pre style="background-color:#fff">data <span style="color:#000;font-weight:bold">=</span> make_blobs(n_samples<span style="color:#000;font-weight:bold">=</span><span style="color:#099">50</span>, n_features<span style="color:#000;font-weight:bold">=</span><span style="color:#099">2</span>, centers<span style="color:#000;font-weight:bold">=</span><span style="color:#099">3</span>, cluster_std<span style="color:#000;font-weight:bold">=</span><span style="color:#099">1.5</span>)
</pre><pre style="background-color:#fff">transformation <span style="color:#000;font-weight:bold">=</span> [<span style="color:#099">0.5</span>, <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.5</span>], [<span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.4</span>, <span style="color:#099">0.8</span>](<span style="color:#099">0.5</span>,<span style="color:#000;font-weight:bold">--</span><span style="color:#099">0.5</span>],<span style="color:#000;font-weight:bold">-</span>[<span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.4</span>,<span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.8</span><span style="color:#000;font-weight:bold">.</span>html)
</pre><pre style="background-color:#fff">data_0 <span style="color:#000;font-weight:bold">=</span> np<span style="color:#000;font-weight:bold">.</span>dot(data[<span style="color:#099">0</span>], transformation)
df <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>DataFrame(data_0, columns<span style="color:#000;font-weight:bold">=</span>[f<span style="color:#d14">&#34;f{i}&#34;</span> <span style="color:#000;font-weight:bold">for</span> i <span style="color:#000;font-weight:bold">in</span> <span style="color:#0086b3">range</span>(<span style="color:#099">1</span>, <span style="color:#099">3</span>)])
df[<span style="color:#d14">&#34;y&#34;</span>] <span style="color:#000;font-weight:bold">=</span> data[<span style="color:#099">1</span>]
</pre><pre style="background-color:#fff">plt<span style="color:#000;font-weight:bold">.</span>scatter(
    df[<span style="color:#d14">&#34;f1&#34;</span>],
    df[<span style="color:#d14">&#34;f2&#34;</span>],
    c<span style="color:#000;font-weight:bold">=</span>df[<span style="color:#d14">&#34;y&#34;</span>]<span style="color:#000;font-weight:bold">.</span>apply(<span style="color:#000;font-weight:bold">lambda</span> y: colours[y]),
    s<span style="color:#000;font-weight:bold">=</span><span style="color:#099">50</span>,
    edgecolors<span style="color:#000;font-weight:bold">=</span>df[<span style="color:#d14">&#34;y&#34;</span>]<span style="color:#000;font-weight:bold">.</span>apply(<span style="color:#000;font-weight:bold">lambda</span> y: edges[y]),
)
plt<span style="color:#000;font-weight:bold">.</span>xlabel(<span style="color:#d14">&#34;f1&#34;</span>)
plt<span style="color:#000;font-weight:bold">.</span>ylabel(<span style="color:#d14">&#34;f2&#34;</span>)
plt<span style="color:#000;font-weight:bold">.</span>show()
</pre><p><img src="./figures/Synthetic%20Data%20Generation_43_0.png" alt="png" /></p>
<h2 id="concentric-clusters">Concentric clusters</h2>
<p>Sometimes we might be interested in creating a non-separable cluster.</p>
<p>The simples way is to create concentric clusters with the <code>make_circles</code> method.</p>
<pre style="background-color:#fff"><span style="color:#000;font-weight:bold">from</span> <span style="color:#555">sklearn.datasets</span> <span style="color:#000;font-weight:bold">import</span> make_circles

data <span style="color:#000;font-weight:bold">=</span> make_circles(
    n_samples<span style="color:#000;font-weight:bold">=</span>N_SAMPLES, shuffle<span style="color:#000;font-weight:bold">=</span><span style="color:#999">True</span>, noise<span style="color:#000;font-weight:bold">=</span><span style="color:#999">None</span>, random_state<span style="color:#000;font-weight:bold">=</span>random_state, factor<span style="color:#000;font-weight:bold">=</span><span style="color:#099">0.6</span>
)
df <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>DataFrame(data[<span style="color:#099">0</span>], columns<span style="color:#000;font-weight:bold">=</span>[f<span style="color:#d14">&#34;f{i+1}&#34;</span> <span style="color:#000;font-weight:bold">for</span> i <span style="color:#000;font-weight:bold">in</span> <span style="color:#0086b3">range</span>(<span style="color:#099">2</span>)])
df[<span style="color:#d14">&#34;y&#34;</span>] <span style="color:#000;font-weight:bold">=</span> data[<span style="color:#099">1</span>]
</pre><pre style="background-color:#fff">plt<span style="color:#000;font-weight:bold">.</span>scatter(
    df[<span style="color:#d14">&#34;f1&#34;</span>],
    df[<span style="color:#d14">&#34;f2&#34;</span>],
    c<span style="color:#000;font-weight:bold">=</span>df[<span style="color:#d14">&#34;y&#34;</span>]<span style="color:#000;font-weight:bold">.</span>apply(<span style="color:#000;font-weight:bold">lambda</span> y: colours[y]),
    s<span style="color:#000;font-weight:bold">=</span><span style="color:#099">50</span>,
    edgecolors<span style="color:#000;font-weight:bold">=</span>df[<span style="color:#d14">&#34;y&#34;</span>]<span style="color:#000;font-weight:bold">.</span>apply(<span style="color:#000;font-weight:bold">lambda</span> y: edges[y]),
)
plt<span style="color:#000;font-weight:bold">.</span>xlabel(<span style="color:#d14">&#34;f1&#34;</span>)
plt<span style="color:#000;font-weight:bold">.</span>ylabel(<span style="color:#d14">&#34;f2&#34;</span>)
plt<span style="color:#000;font-weight:bold">.</span>show()
</pre><p><img src="./figures/Synthetic%20Data%20Generation_47_0.png" alt="png" /></p>
<h3 id="adding-noise">Adding noise</h3>
<p>The <code>noise</code> parameter allows to create a concentric noisy dataset.</p>
<pre style="background-color:#fff">data <span style="color:#000;font-weight:bold">=</span> make_circles(
    n_samples<span style="color:#000;font-weight:bold">=</span>N_SAMPLES, shuffle<span style="color:#000;font-weight:bold">=</span><span style="color:#999">True</span>, noise<span style="color:#000;font-weight:bold">=</span><span style="color:#099">0.15</span>, random_state<span style="color:#000;font-weight:bold">=</span>random_state, factor<span style="color:#000;font-weight:bold">=</span><span style="color:#099">0.6</span>
)
df <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>DataFrame(data[<span style="color:#099">0</span>], columns<span style="color:#000;font-weight:bold">=</span>[f<span style="color:#d14">&#34;f{i+1}&#34;</span> <span style="color:#000;font-weight:bold">for</span> i <span style="color:#000;font-weight:bold">in</span> <span style="color:#0086b3">range</span>(<span style="color:#099">2</span>)])
df[<span style="color:#d14">&#34;y&#34;</span>] <span style="color:#000;font-weight:bold">=</span> data[<span style="color:#099">1</span>]
</pre><pre style="background-color:#fff">plt<span style="color:#000;font-weight:bold">.</span>scatter(
    df[<span style="color:#d14">&#34;f1&#34;</span>],
    df[<span style="color:#d14">&#34;f2&#34;</span>],
    c<span style="color:#000;font-weight:bold">=</span>df[<span style="color:#d14">&#34;y&#34;</span>]<span style="color:#000;font-weight:bold">.</span>apply(<span style="color:#000;font-weight:bold">lambda</span> y: colours[y]),
    s<span style="color:#000;font-weight:bold">=</span><span style="color:#099">50</span>,
    edgecolors<span style="color:#000;font-weight:bold">=</span>df[<span style="color:#d14">&#34;y&#34;</span>]<span style="color:#000;font-weight:bold">.</span>apply(<span style="color:#000;font-weight:bold">lambda</span> y: edges[y]),
)
plt<span style="color:#000;font-weight:bold">.</span>xlabel(<span style="color:#d14">&#34;f1&#34;</span>)
plt<span style="color:#000;font-weight:bold">.</span>ylabel(<span style="color:#d14">&#34;f2&#34;</span>)
plt<span style="color:#000;font-weight:bold">.</span>show()
</pre><p><img src="./figures/Synthetic%20Data%20Generation_50_0.png" alt="png" /></p>
<h2 id="moon-clusters">Moon clusters</h2>
<p>A shape that can be useful to other methos (such as counterfactuals, for instance) is the <code>make_moons</code> method.</p>
<pre style="background-color:#fff"><span style="color:#000;font-weight:bold">from</span> <span style="color:#555">sklearn.datasets</span> <span style="color:#000;font-weight:bold">import</span> make_moons

data <span style="color:#000;font-weight:bold">=</span> make_moons(
    n_samples<span style="color:#000;font-weight:bold">=</span>N_SAMPLES, shuffle<span style="color:#000;font-weight:bold">=</span><span style="color:#999">True</span>, noise<span style="color:#000;font-weight:bold">=</span><span style="color:#999">None</span>, random_state<span style="color:#000;font-weight:bold">=</span>random_state
)
df <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>DataFrame(data[<span style="color:#099">0</span>], columns<span style="color:#000;font-weight:bold">=</span>[f<span style="color:#d14">&#34;f{i+1}&#34;</span> <span style="color:#000;font-weight:bold">for</span> i <span style="color:#000;font-weight:bold">in</span> <span style="color:#0086b3">range</span>(<span style="color:#099">2</span>)])
df[<span style="color:#d14">&#34;y&#34;</span>] <span style="color:#000;font-weight:bold">=</span> data[<span style="color:#099">1</span>]
</pre><pre style="background-color:#fff">plt<span style="color:#000;font-weight:bold">.</span>scatter(
    df[<span style="color:#d14">&#34;f1&#34;</span>],
    df[<span style="color:#d14">&#34;f2&#34;</span>],
    c<span style="color:#000;font-weight:bold">=</span>df[<span style="color:#d14">&#34;y&#34;</span>]<span style="color:#000;font-weight:bold">.</span>apply(<span style="color:#000;font-weight:bold">lambda</span> y: colours[y]),
    s<span style="color:#000;font-weight:bold">=</span><span style="color:#099">50</span>,
    edgecolors<span style="color:#000;font-weight:bold">=</span>df[<span style="color:#d14">&#34;y&#34;</span>]<span style="color:#000;font-weight:bold">.</span>apply(<span style="color:#000;font-weight:bold">lambda</span> y: edges[y]),
)
plt<span style="color:#000;font-weight:bold">.</span>xlabel(<span style="color:#d14">&#34;f1&#34;</span>)
plt<span style="color:#000;font-weight:bold">.</span>ylabel(<span style="color:#d14">&#34;f2&#34;</span>)
plt<span style="color:#000;font-weight:bold">.</span>show()
</pre><p><img src="./figures/Synthetic%20Data%20Generation_53_0.png" alt="png" /></p>
<h3 id="adding-noise-1">Adding noise</h3>
<p>As usual, the <code>noise</code> parameter allows to control the noise.</p>
<pre style="background-color:#fff">data <span style="color:#000;font-weight:bold">=</span> make_moons(
    n_samples<span style="color:#000;font-weight:bold">=</span>N_SAMPLES, shuffle<span style="color:#000;font-weight:bold">=</span><span style="color:#999">True</span>, noise<span style="color:#000;font-weight:bold">=</span><span style="color:#099">0.1</span>, random_state<span style="color:#000;font-weight:bold">=</span>random_state
)
df <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>DataFrame(data[<span style="color:#099">0</span>], columns<span style="color:#000;font-weight:bold">=</span>[f<span style="color:#d14">&#34;f{i+1}&#34;</span> <span style="color:#000;font-weight:bold">for</span> i <span style="color:#000;font-weight:bold">in</span> <span style="color:#0086b3">range</span>(<span style="color:#099">2</span>)])
df[<span style="color:#d14">&#34;y&#34;</span>] <span style="color:#000;font-weight:bold">=</span> data[<span style="color:#099">1</span>]
</pre><pre style="background-color:#fff">plt<span style="color:#000;font-weight:bold">.</span>scatter(
    df[<span style="color:#d14">&#34;f1&#34;</span>],
    df[<span style="color:#d14">&#34;f2&#34;</span>],
    c<span style="color:#000;font-weight:bold">=</span>df[<span style="color:#d14">&#34;y&#34;</span>]<span style="color:#000;font-weight:bold">.</span>apply(<span style="color:#000;font-weight:bold">lambda</span> y: colours[y]),
    s<span style="color:#000;font-weight:bold">=</span><span style="color:#099">50</span>,
    edgecolors<span style="color:#000;font-weight:bold">=</span>df[<span style="color:#d14">&#34;y&#34;</span>]<span style="color:#000;font-weight:bold">.</span>apply(<span style="color:#000;font-weight:bold">lambda</span> y: edges[y]),
)
plt<span style="color:#000;font-weight:bold">.</span>xlabel(<span style="color:#d14">&#34;f1&#34;</span>)
plt<span style="color:#000;font-weight:bold">.</span>ylabel(<span style="color:#d14">&#34;f2&#34;</span>)
plt<span style="color:#000;font-weight:bold">.</span>show()
</pre><p><img src="./figures/Synthetic%20Data%20Generation_56_0.png" alt="png" /></p>
<div class="footnotes" role="doc-endnotes">
<hr />
<ol>
<li id="fn:1" role="doc-endnote">
<p>https://scikit-learn.org/stable/modules/generated/sklearn.datasets.make_classification.html <a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</div>

    <div class="footer">
        <span class="cc-symbol">&#127341;</span> 2020 CC BY Rui Vieira
    </div>
</div>

</body>
</html>