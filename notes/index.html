<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <script type="text/javascript" src="/js/pyodide.js"></script>
    <title>Some tests with pyodide</title>
    <script type="text/javascript">
        languagePluginLoader.then(() => {
            // pyodide is now ready to use...
            console.log(pyodide.runPython('import sys\nsys.version'));
            pyodide.loadPackage('matplotlib').then(() => {
                pyodide.runPython(`
                import matplotlib.pyplot as plt
                import io, base64

                fig, ax = plt.subplots()
                ax.plot([1,3,2])

                buf = io.BytesIO()
                fig.savefig(buf, format='png')
                buf.seek(0)
                img_str = 'data:image/png;base64,' + base64.b64encode(buf.read()).decode('UTF-8')`
          );

                document.getElementById("pyplotfigure").src=pyodide.globals.img_str
            });
        });
    </script>
</head>
<body>
    <div id="textfield">A matplotlib figure:</div>
    <div id="pyplotdiv"><img id="pyplotfigure"/></div>
</body>
</html>